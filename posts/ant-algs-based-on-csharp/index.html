<!DOCTYPE html>
<html>
  <head>
    
    
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>
      
  基于C#的蚁群算法实现 &ndash; 流水沉微

    </title>
    
    
    <meta name="description" property="og:description" content="这学期有门课，最优化与最优控制，任课老师任华玲，虽然在课堂上我什么都没有学到，但是最后任老师让每个人|Hacking to the world">
    

    <meta name="apple-mobile-web-app-title" content="流水沉微">
    
    
    <link rel="icon" href="/favicon-64.png">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="mask-icon" size="any" href="/pinned-icon.svg">
    
    
    


    <link rel="stylesheet" href="/assets/syntax.css">
    <link rel="stylesheet" href="/assets/primer-build.css">
    <link rel="stylesheet" href="/assets/style.css">
  </head>


  <body class="bg-gray">
    <div id="holy" class="container-lg bg-white h-100">

      <div id="header" class="px-1 bg-white">
        <nav class="UnderlineNav UnderlineNav--right px-2">
  <a class="UnderlineNav-actions muted-link h2" href="http://shuxiao.wang">
    流水沉微
  </a>

  
  
  <div class="UnderlineNav-body">
    
    
    <a class="UnderlineNav-item " href="/posts/">
      
      <span>Posts</span>
    </a>
    
    
    
    <a class="UnderlineNav-item " href="/">
      
      <span>About</span>
    </a>
    
    
  </div>
  
</nav>

      </div>

      <div role="main" id="main" class="holy-main markdown-body px-4 bg-white">
        

<div class="Subhead">
  <div class="Subhead-heading">
    <div class="h1 mt-3 mb-1">基于C#的蚁群算法实现</div>
  </div>
  <div class="Subhead-description">
    


<a href='/categories/programming' class="muted-link">
  <span class="Label Label--gray-darker">programming</span>
</a>



<a href='/tags/homework' class="muted-link">
  <span class="Label Label--gray">homework</span>
</a>



    
    <div class="float-md-right">
      <span title="Lastmod: 2019-05-17. Published at: 2014-10-25.">
        
          Lastmod: 2019-05-17
        
      </span>
    </div>
    
  </div>
</div>
<article>
  
  <section class="pb-6 mb-3 border-bottom">
    <p>这学期有门课，最优化与最优控制，任课老师任华玲，虽然在课堂上我什么都没有学到，但是最后任老师让每个人自己选一篇最优化方向的论文，把其中的算法和算例自己实现一下，并讲解。本科时祝凌曦让我研究过蚁群算法，当时没太弄懂，趁这个机会研究了下，弄懂了并用C#实现出来，效果还不错。以下是代码。</p>

<p>代码主要分为三块：Ant.cs，Tsp.cs和DataAndCal.cs，分别为蚂蚁类，tsp类和静态数据储存计算类。</p>

<p>首先是蚂蚁类：
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">AntColonyOptimization</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Ant</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="kt">int</span><span class="na">[]</span> <span class="n">DoneCity</span><span class="p">;</span><span class="c1">//去过的城市，值是依次经过的城市的编号
</span><span class="c1"></span>        <span class="k">public</span> <span class="kt">int</span> <span class="n">DoneCityCount</span><span class="p">;</span><span class="c1">//去过的城市数量
</span><span class="c1"></span>        <span class="k">public</span> <span class="kt">int</span><span class="na">[]</span> <span class="n">IngCity</span><span class="p">;</span> <span class="c1">//没去过的城市,序号是城市自带的，这里面的值代表是否去过，1去过，0没有去过
</span><span class="c1"></span>        <span class="k">public</span> <span class="kt">int</span> <span class="n">NowCityNo</span><span class="p">;</span> <span class="c1">//当前城市编号
</span><span class="c1"></span>        <span class="k">public</span> <span class="kt">double</span> <span class="n">LineLength</span><span class="p">;</span> <span class="c1">//路径总长
</span><span class="c1"></span>
        <span class="c1">// 新建一个蚂蚁，用于储存最优值
</span><span class="c1"></span>        <span class="k">public</span> <span class="n">Ant</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">IngCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="na">[DataAndCal.CityNum]</span><span class="p">;</span>
            <span class="n">DoneCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">int</span><span class="na">[DataAndCal.CityNum]</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// 一只蚂蚁完成一次旅行
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">void</span> <span class="n">Travel</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//1. 初始化//2. 选择一个初始城市
</span><span class="c1"></span>            <span class="n">AntInit</span><span class="p">();</span>

            <span class="k">while</span> <span class="p">(</span><span class="n">DoneCityCount</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="c1">//3. 选择下一个城市            
</span><span class="c1"></span>                <span class="kt">int</span> <span class="n">nextCityNo</span> <span class="p">=</span> <span class="n">SelectNextCity</span><span class="p">();</span>

                <span class="c1">//4. 移动过去，更新数据
</span><span class="c1"></span>                <span class="n">Move</span><span class="p">(</span><span class="n">nextCityNo</span><span class="p">);</span>

            <span class="p">}</span>
            <span class="c1">//5. 移动完成后，计算路径总长
</span><span class="c1"></span>            <span class="n">LineLength</span> <span class="p">=</span> <span class="m">0.0</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">LineLength</span> <span class="p">=</span> <span class="n">LineLength</span> <span class="p">+</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">DistenceBetween2City</span><span class="p">(</span><span class="n">DoneCity</span><span class="na">[i]</span><span class="p">,</span> <span class="n">DoneCity</span><span class="na">[i + 1]</span><span class="p">);</span>
            <span class="p">}</span>
            <span class="n">LineLength</span> <span class="p">=</span> <span class="n">LineLength</span> <span class="p">+</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">DistenceBetween2City</span><span class="p">(</span><span class="n">DoneCity</span><span class="na">[0]</span><span class="p">,</span> <span class="n">DoneCity</span><span class="na">[DataAndCal.CityNum - 1]</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// 蚂蚁初始化
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">void</span> <span class="n">AntInit</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">DoneCity</span><span class="na">[i]</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="n">IngCity</span><span class="na">[i]</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="p">}</span>
            <span class="n">NowCityNo</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="n">LineLength</span> <span class="p">=</span> <span class="m">0.0</span><span class="p">;</span>

            <span class="c1">//随机选择一个城市出发并记录
</span><span class="c1"></span>            <span class="n">NowCityNo</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">RandInt</span><span class="p">(</span><span class="m">1</span><span class="p">,</span> <span class="m">51</span><span class="p">);</span>
            <span class="n">DoneCity</span><span class="na">[0]</span> <span class="p">=</span> <span class="n">NowCityNo</span><span class="p">;</span>
            <span class="n">DoneCityCount</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
            <span class="n">IngCity</span><span class="na">[NowCityNo]</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">public</span> <span class="kt">int</span> <span class="n">SelectNextCity</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">int</span> <span class="n">SelectNo</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="c1">//初始化要选择的城市的编号
</span><span class="c1"></span>            <span class="kt">double</span> <span class="n">info</span> <span class="p">=</span> <span class="m">0.0</span><span class="p">;</span> <span class="c1">//统计信息素的总和
</span><span class="c1"></span>            <span class="kt">double</span><span class="na">[]</span> <span class="n">Pos</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[DataAndCal.CityNum]</span><span class="p">;</span> <span class="c1">//去每个城市的概率
</span><span class="c1"></span>
            <span class="c1">// 计算去每个城市的概率
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">IngCity</span><span class="na">[i]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span> <span class="c1">//没去过该城市
</span><span class="c1"></span>                <span class="p">{</span>
                    <span class="n">Pos</span><span class="na">[i]</span> <span class="p">=</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">InfoBetwCity</span><span class="na">[NowCityNo, i]</span><span class="p">,</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">alpha</span><span class="p">))</span> <span class="p">/</span> <span class="p">(</span><span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">DistenceBetween2City</span><span class="p">(</span><span class="n">NowCityNo</span><span class="p">,</span> <span class="n">i</span><span class="p">),</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">beta</span><span class="p">));</span>
                    <span class="n">info</span> <span class="p">+=</span> <span class="n">Pos</span><span class="na">[i]</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">Pos</span><span class="na">[i]</span> <span class="p">=</span> <span class="m">0.0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">// 按概率进行选择
</span><span class="c1"></span>            <span class="kt">double</span> <span class="n">randInfo</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">RandDouble</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="n">info</span><span class="p">);</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">randInfo</span> <span class="p">-</span> <span class="n">Pos</span><span class="na">[i]</span> <span class="p">&gt;</span> <span class="m">0</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">randInfo</span> <span class="p">=</span> <span class="n">randInfo</span> <span class="p">-</span> <span class="n">Pos</span><span class="na">[i]</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">else</span>
                <span class="p">{</span>
                    <span class="n">SelectNo</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
                    <span class="k">break</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">//如果没有通过计算得到合适的结果，那么直接指定序号中第一个没有去过的城市作为下一个城市
</span><span class="c1"></span>            <span class="k">if</span> <span class="p">(</span><span class="n">SelectNo</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="k">if</span> <span class="p">(</span><span class="n">IngCity</span><span class="na">[i]</span> <span class="p">==</span> <span class="m">0</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">SelectNo</span> <span class="p">=</span> <span class="n">i</span><span class="p">;</span>
                        <span class="k">break</span><span class="p">;</span>
                    <span class="p">}</span>
                <span class="p">}</span>

            <span class="p">}</span>
            <span class="k">return</span> <span class="n">SelectNo</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">void</span> <span class="n">Move</span><span class="p">(</span><span class="kt">int</span> <span class="n">nextCityNo</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="c1">//下一个城市添加到已经途经的路径数组
</span><span class="c1"></span>            <span class="n">DoneCity</span><span class="na">[DoneCityCount]</span> <span class="p">=</span> <span class="n">nextCityNo</span><span class="p">;</span>
            <span class="c1">//该城市标记为已经去过
</span><span class="c1"></span>            <span class="n">IngCity</span><span class="na">[nextCityNo]</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
            <span class="c1">//增加路径总长
</span><span class="c1"></span>            <span class="n">LineLength</span> <span class="p">=</span> <span class="n">LineLength</span> <span class="p">+</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">DistenceBetween2City</span><span class="p">(</span><span class="n">NowCityNo</span><span class="p">,</span> <span class="n">nextCityNo</span><span class="p">);</span>
            <span class="c1">//移动到下一城市，把下一城市成为当前城市
</span><span class="c1"></span>            <span class="n">NowCityNo</span> <span class="p">=</span> <span class="n">nextCityNo</span><span class="p">;</span>
            <span class="n">DoneCityCount</span><span class="p">++;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></p>

<p>注释都写得比较清楚，就不再解释了，毕竟就是用蚁群算法实现了一个最简单的Tsp问题求解。下面是Tsp类：
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">AntColonyOptimization</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">Tsp</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">Ant</span><span class="na">[]</span> <span class="n">Ants</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">Ant</span> <span class="n">bestAnt</span><span class="p">;</span>
        <span class="k">public</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Ant</span><span class="p">&gt;</span> <span class="n">bestAntList</span><span class="p">;</span>

        <span class="k">public</span> <span class="n">Tsp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">Ants</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Ant</span><span class="na">[DataAndCal.AntNum]</span><span class="p">;</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">AntNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">Ants</span><span class="na">[i]</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Ant</span><span class="p">();</span>
            <span class="p">}</span>
            <span class="n">bestAnt</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Ant</span><span class="p">();</span>
            <span class="c1">//bestAntList = new List&lt;Ant&gt;();
</span><span class="c1"></span>        <span class="p">}</span>

        <span class="c1">// 初始化全部环境
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">void</span> <span class="n">InitEnvironment</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//最优值先设定为BigNum
</span><span class="c1"></span>            <span class="n">bestAnt</span><span class="p">.</span><span class="n">LineLength</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">BigNum</span><span class="p">;</span>

            <span class="c1">// 初始化环境信息素
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">DataAndCal</span><span class="p">.</span><span class="n">InfoBetwCity</span><span class="na">[i, j]</span> <span class="p">=</span> <span class="m">1.0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>

        <span class="c1">//更新信息素
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">void</span> <span class="n">UpdateInfo</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="kt">double</span><span class="na">[,]</span> <span class="n">AntInfo</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[DataAndCal.CityNum, DataAndCal.CityNum]</span><span class="p">;</span>

            <span class="c1">//计算妹纸蚂蚁留下的信息素, 先全部清零
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">AntInfo</span><span class="na">[i, j]</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="c1">//新增的信息素
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">AntNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="c1">// 第i只蚂蚁，在经过的第j和j+1个城市间留下的信息素，是总信息素/第i只蚂蚁走过的路径总长,并加第i只蚂蚁的信息素叠加到j和j+1个城市上去。
</span><span class="c1"></span>                    <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j + 1]</span><span class="p">]</span> <span class="p">=</span> <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j + 1]</span><span class="p">]</span> <span class="p">+</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">TotalInfo</span> <span class="p">/</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">LineLength</span><span class="p">;</span>
                    <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j + 1]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j]</span><span class="p">]</span> <span class="p">=</span> <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[j + 1]</span><span class="p">];</span>
                <span class="p">}</span>

                <span class="c1">//最后一个城市和第一个城市
</span><span class="c1"></span>                <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[0]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[DataAndCal.CityNum - 1]</span><span class="p">]</span> <span class="p">=</span> <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[0]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[DataAndCal.CityNum - 1]</span><span class="p">]</span> <span class="p">+</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">TotalInfo</span> <span class="p">/</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">LineLength</span><span class="p">;</span>
                <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[DataAndCal.CityNum - 1]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[0]</span><span class="p">]</span> <span class="p">=</span> <span class="n">AntInfo</span><span class="na">[Ants[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[0]</span><span class="p">,</span> <span class="n">Ants</span><span class="na">[i]</span><span class="p">.</span><span class="n">DoneCity</span><span class="na">[DataAndCal.CityNum - 1]</span><span class="p">];</span>
            <span class="p">}</span>

            <span class="c1">//更新信息素，原始值*挥发+新增值
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">DataAndCal</span><span class="p">.</span><span class="n">InfoBetwCity</span><span class="na">[i, j]</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">InfoBetwCity</span><span class="na">[i, j]</span> <span class="p">*</span> <span class="p">(</span><span class="m">1</span> <span class="p">-</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">rou</span><span class="p">)</span> <span class="p">+</span> <span class="n">AntInfo</span><span class="na">[i, j]</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>


        <span class="p">}</span>

        <span class="c1">// 全部搜索一遍
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">void</span> <span class="n">Search</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//迭代次数内循环
</span><span class="c1"></span>            <span class="n">bestAntList</span> <span class="p">=</span> <span class="k">new</span> <span class="n">List</span><span class="p">&lt;</span><span class="n">Ant</span><span class="p">&gt;();</span>
            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">IterateTime</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="c1">//每只蚂蚁都搜索
</span><span class="c1"></span>                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">j</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">j</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">AntNum</span><span class="p">;</span> <span class="n">j</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">Ants</span><span class="na">[j]</span><span class="p">.</span><span class="n">Travel</span><span class="p">();</span>

                    <span class="k">if</span> <span class="p">(</span><span class="n">Ants</span><span class="na">[j]</span><span class="p">.</span><span class="n">LineLength</span> <span class="p">&lt;</span> <span class="n">bestAnt</span><span class="p">.</span><span class="n">LineLength</span><span class="p">)</span>
                    <span class="p">{</span>
                        <span class="n">bestAnt</span><span class="p">.</span><span class="n">LineLength</span> <span class="p">=</span> <span class="n">Ants</span><span class="na">[j]</span><span class="p">.</span><span class="n">LineLength</span><span class="p">;</span>
                        <span class="n">bestAnt</span><span class="p">.</span><span class="n">DoneCity</span> <span class="p">=</span> <span class="n">Ants</span><span class="na">[j]</span><span class="p">.</span><span class="n">DoneCity</span><span class="p">;</span>
                        <span class="n">Ant</span> <span class="n">tmp</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Ant</span><span class="p">();</span>
                        <span class="n">tmp</span><span class="p">.</span><span class="n">LineLength</span> <span class="p">=</span> <span class="n">Ants</span><span class="na">[j]</span><span class="p">.</span><span class="n">LineLength</span><span class="p">;</span>
                        <span class="n">tmp</span><span class="p">.</span><span class="n">DoneCity</span> <span class="p">=</span> <span class="n">Ants</span><span class="na">[j]</span><span class="p">.</span><span class="n">DoneCity</span><span class="p">;</span>
                        <span class="n">bestAntList</span><span class="p">.</span><span class="n">Add</span><span class="p">(</span><span class="n">tmp</span><span class="p">);</span>
                    <span class="p">}</span>
                <span class="p">}</span>
                <span class="c1">//更新信息素
</span><span class="c1"></span>                <span class="c1">//UpdateInfo();
</span><span class="c1"></span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></p>

<p>接下来是静态数据储存计算类：
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span><span class="lnt">82
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>


<span class="k">namespace</span> <span class="nn">AntColonyOptimization</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">static</span> <span class="k">class</span> <span class="nc">DataAndCal</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="n">alpha</span> <span class="p">=</span> <span class="m">1.0</span><span class="p">;</span> <span class="c1">//信息素重要程度
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="n">beta</span> <span class="p">=</span> <span class="m">2.0</span><span class="p">;</span> <span class="c1">//城市间距离重要程度
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="n">rou</span> <span class="p">=</span> <span class="m">0.5</span><span class="p">;</span> <span class="c1">//信息残留程度
</span><span class="c1"></span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">AntNum</span> <span class="p">=</span> <span class="m">34</span><span class="p">;</span> <span class="c1">//蚂蚁数量
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">IterateTime</span> <span class="p">=</span> <span class="m">1000</span><span class="p">;</span> <span class="c1">//迭代次数
</span><span class="c1"></span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">CityNum</span> <span class="p">=</span> <span class="m">51</span><span class="p">;</span> <span class="c1">//城市数量
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="n">TotalInfo</span> <span class="p">=</span> <span class="m">100.0</span><span class="p">;</span> <span class="c1">//总信息素
</span><span class="c1"></span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span><span class="na">[,]</span> <span class="n">InfoBetwCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[CityNum, CityNum]</span><span class="p">;</span> <span class="c1">//两城市间信息素
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span><span class="na">[,]</span> <span class="n">DistBetwCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[CityNum, CityNum]</span><span class="p">;</span> <span class="c1">//两城市间距离
</span><span class="c1"></span>
        <span class="c1">// 城市坐标，用x,y分别表示
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span><span class="na">[]</span> <span class="n">xCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[]</span>
        <span class="p">{</span>
	        <span class="m">37</span><span class="p">,</span><span class="m">49</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">20</span><span class="p">,</span><span class="m">40</span><span class="p">,</span><span class="m">21</span><span class="p">,</span><span class="m">17</span><span class="p">,</span><span class="m">31</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">51</span><span class="p">,</span>
	        <span class="m">42</span><span class="p">,</span><span class="m">31</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">36</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">27</span><span class="p">,</span><span class="m">17</span><span class="p">,</span><span class="m">13</span><span class="p">,</span><span class="m">57</span><span class="p">,</span>
	        <span class="m">62</span><span class="p">,</span><span class="m">42</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">8</span><span class="p">,</span><span class="m">7</span><span class="p">,</span><span class="m">27</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">43</span><span class="p">,</span><span class="m">58</span><span class="p">,</span><span class="m">58</span><span class="p">,</span>
	        <span class="m">37</span><span class="p">,</span><span class="m">38</span><span class="p">,</span><span class="m">46</span><span class="p">,</span><span class="m">61</span><span class="p">,</span><span class="m">62</span><span class="p">,</span><span class="m">63</span><span class="p">,</span><span class="m">32</span><span class="p">,</span><span class="m">45</span><span class="p">,</span><span class="m">59</span><span class="p">,</span><span class="m">5</span><span class="p">,</span>
	        <span class="m">10</span><span class="p">,</span><span class="m">21</span><span class="p">,</span><span class="m">5</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">39</span><span class="p">,</span><span class="m">32</span><span class="p">,</span><span class="m">25</span><span class="p">,</span><span class="m">25</span><span class="p">,</span><span class="m">48</span><span class="p">,</span><span class="m">56</span><span class="p">,</span>
	        <span class="m">30</span>
        <span class="p">};</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span><span class="na">[]</span> <span class="n">yCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[]</span>
        <span class="p">{</span>
            <span class="m">52</span><span class="p">,</span><span class="m">49</span><span class="p">,</span><span class="m">64</span><span class="p">,</span><span class="m">26</span><span class="p">,</span><span class="m">30</span><span class="p">,</span><span class="m">47</span><span class="p">,</span><span class="m">63</span><span class="p">,</span><span class="m">62</span><span class="p">,</span><span class="m">33</span><span class="p">,</span><span class="m">21</span><span class="p">,</span>
            <span class="m">41</span><span class="p">,</span><span class="m">32</span><span class="p">,</span><span class="m">25</span><span class="p">,</span><span class="m">42</span><span class="p">,</span><span class="m">16</span><span class="p">,</span><span class="m">41</span><span class="p">,</span><span class="m">23</span><span class="p">,</span><span class="m">33</span><span class="p">,</span><span class="m">13</span><span class="p">,</span><span class="m">58</span><span class="p">,</span>
            <span class="m">42</span><span class="p">,</span><span class="m">57</span><span class="p">,</span><span class="m">57</span><span class="p">,</span><span class="m">52</span><span class="p">,</span><span class="m">38</span><span class="p">,</span><span class="m">68</span><span class="p">,</span><span class="m">48</span><span class="p">,</span><span class="m">67</span><span class="p">,</span><span class="m">48</span><span class="p">,</span><span class="m">27</span><span class="p">,</span>
            <span class="m">69</span><span class="p">,</span><span class="m">46</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">33</span><span class="p">,</span><span class="m">63</span><span class="p">,</span><span class="m">69</span><span class="p">,</span><span class="m">22</span><span class="p">,</span><span class="m">35</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">6</span><span class="p">,</span>
            <span class="m">17</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">64</span><span class="p">,</span><span class="m">15</span><span class="p">,</span><span class="m">10</span><span class="p">,</span><span class="m">39</span><span class="p">,</span><span class="m">32</span><span class="p">,</span><span class="m">55</span><span class="p">,</span><span class="m">28</span><span class="p">,</span><span class="m">37</span><span class="p">,</span>
            <span class="m">40</span>
        <span class="p">};</span>

        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// 两城市间距离
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;param name=&#34;City1No&#34;&gt;第一个城市的序号&lt;/param&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;param name=&#34;City2No&#34;&gt;第二个城市序号&lt;/param&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="n">DistenceBetween2City</span><span class="p">(</span><span class="kt">int</span> <span class="n">City1No</span><span class="p">,</span> <span class="kt">int</span> <span class="n">City2No</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">double</span> <span class="n">x1x2</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">((</span><span class="n">xCity</span><span class="na">[City1No]</span> <span class="p">-</span> <span class="n">xCity</span><span class="na">[City2No]</span><span class="p">),</span> <span class="m">2</span><span class="p">);</span>
            <span class="kt">double</span> <span class="n">y1y2</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">((</span><span class="n">yCity</span><span class="na">[City1No]</span> <span class="p">-</span> <span class="n">yCity</span><span class="na">[City2No]</span><span class="p">),</span> <span class="m">2</span><span class="p">);</span>
            <span class="kt">double</span> <span class="n">dis</span> <span class="p">=</span> <span class="n">Math</span><span class="p">.</span><span class="n">Pow</span><span class="p">((</span><span class="n">x1x2</span><span class="p">+</span><span class="n">y1y2</span><span class="p">),</span><span class="m">0.5</span><span class="p">);</span>
            <span class="k">return</span> <span class="n">dis</span><span class="p">;</span>
        <span class="p">}</span>


        <span class="k">public</span> <span class="k">static</span> <span class="n">Random</span> <span class="n">ran</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Random</span><span class="p">(</span><span class="n">System</span><span class="p">.</span><span class="n">DateTime</span><span class="p">.</span><span class="n">Now</span><span class="p">.</span><span class="n">Millisecond</span><span class="p">);</span>
        <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">BigNum</span> <span class="p">=</span> <span class="m">65535</span><span class="p">;</span>
        <span class="c1">/// &lt;summary&gt;
</span><span class="c1"></span>        <span class="c1">/// 产生一个随机整数，区间是n1，n2
</span><span class="c1"></span>        <span class="c1">/// &lt;/summary&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;param name=&#34;n1&#34;&gt;&lt;/param&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;param name=&#34;n2&#34;&gt;&lt;/param&gt;
</span><span class="c1"></span>        <span class="c1">/// &lt;returns&gt;&lt;/returns&gt;
</span><span class="c1"></span>        <span class="k">public</span> <span class="k">static</span> <span class="kt">int</span> <span class="n">RandInt</span><span class="p">(</span><span class="kt">int</span> <span class="n">n1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n2</span><span class="p">)</span>
        <span class="p">{</span>

            <span class="kt">int</span> <span class="n">n</span> <span class="p">=</span> <span class="n">n1</span> <span class="p">+</span> <span class="p">(</span><span class="n">n2</span> <span class="p">-</span> <span class="n">n1</span><span class="p">)</span> <span class="p">*</span> <span class="n">ran</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="n">BigNum</span><span class="p">)</span> <span class="p">/</span> <span class="n">BigNum</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">public</span> <span class="k">static</span> <span class="kt">double</span> <span class="n">RandDouble</span><span class="p">(</span><span class="kt">double</span> <span class="n">n1</span><span class="p">,</span><span class="kt">double</span> <span class="n">n2</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="kt">double</span> <span class="n">n</span> <span class="p">=</span> <span class="n">n1</span> <span class="p">+</span> <span class="p">(</span><span class="n">n2</span> <span class="p">-</span> <span class="n">n1</span><span class="p">)</span> <span class="p">*</span> <span class="n">ran</span><span class="p">.</span><span class="n">Next</span><span class="p">(</span><span class="n">BigNum</span><span class="p">)</span> <span class="p">/</span> <span class="n">BigNum</span><span class="p">;</span>
            <span class="k">return</span> <span class="n">n</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></p>

<p>最后是用C#基于WinForm开发了个窗口进行展示，AntCoOp.cs：
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="lnt">  1
</span><span class="lnt">  2
</span><span class="lnt">  3
</span><span class="lnt">  4
</span><span class="lnt">  5
</span><span class="lnt">  6
</span><span class="lnt">  7
</span><span class="lnt">  8
</span><span class="lnt">  9
</span><span class="lnt"> 10
</span><span class="lnt"> 11
</span><span class="lnt"> 12
</span><span class="lnt"> 13
</span><span class="lnt"> 14
</span><span class="lnt"> 15
</span><span class="lnt"> 16
</span><span class="lnt"> 17
</span><span class="lnt"> 18
</span><span class="lnt"> 19
</span><span class="lnt"> 20
</span><span class="lnt"> 21
</span><span class="lnt"> 22
</span><span class="lnt"> 23
</span><span class="lnt"> 24
</span><span class="lnt"> 25
</span><span class="lnt"> 26
</span><span class="lnt"> 27
</span><span class="lnt"> 28
</span><span class="lnt"> 29
</span><span class="lnt"> 30
</span><span class="lnt"> 31
</span><span class="lnt"> 32
</span><span class="lnt"> 33
</span><span class="lnt"> 34
</span><span class="lnt"> 35
</span><span class="lnt"> 36
</span><span class="lnt"> 37
</span><span class="lnt"> 38
</span><span class="lnt"> 39
</span><span class="lnt"> 40
</span><span class="lnt"> 41
</span><span class="lnt"> 42
</span><span class="lnt"> 43
</span><span class="lnt"> 44
</span><span class="lnt"> 45
</span><span class="lnt"> 46
</span><span class="lnt"> 47
</span><span class="lnt"> 48
</span><span class="lnt"> 49
</span><span class="lnt"> 50
</span><span class="lnt"> 51
</span><span class="lnt"> 52
</span><span class="lnt"> 53
</span><span class="lnt"> 54
</span><span class="lnt"> 55
</span><span class="lnt"> 56
</span><span class="lnt"> 57
</span><span class="lnt"> 58
</span><span class="lnt"> 59
</span><span class="lnt"> 60
</span><span class="lnt"> 61
</span><span class="lnt"> 62
</span><span class="lnt"> 63
</span><span class="lnt"> 64
</span><span class="lnt"> 65
</span><span class="lnt"> 66
</span><span class="lnt"> 67
</span><span class="lnt"> 68
</span><span class="lnt"> 69
</span><span class="lnt"> 70
</span><span class="lnt"> 71
</span><span class="lnt"> 72
</span><span class="lnt"> 73
</span><span class="lnt"> 74
</span><span class="lnt"> 75
</span><span class="lnt"> 76
</span><span class="lnt"> 77
</span><span class="lnt"> 78
</span><span class="lnt"> 79
</span><span class="lnt"> 80
</span><span class="lnt"> 81
</span><span class="lnt"> 82
</span><span class="lnt"> 83
</span><span class="lnt"> 84
</span><span class="lnt"> 85
</span><span class="lnt"> 86
</span><span class="lnt"> 87
</span><span class="lnt"> 88
</span><span class="lnt"> 89
</span><span class="lnt"> 90
</span><span class="lnt"> 91
</span><span class="lnt"> 92
</span><span class="lnt"> 93
</span><span class="lnt"> 94
</span><span class="lnt"> 95
</span><span class="lnt"> 96
</span><span class="lnt"> 97
</span><span class="lnt"> 98
</span><span class="lnt"> 99
</span><span class="lnt">100
</span><span class="lnt">101
</span><span class="lnt">102
</span><span class="lnt">103
</span><span class="lnt">104
</span><span class="lnt">105
</span><span class="lnt">106
</span><span class="lnt">107
</span><span class="lnt">108
</span><span class="lnt">109
</span><span class="lnt">110
</span><span class="lnt">111
</span><span class="lnt">112
</span><span class="lnt">113
</span><span class="lnt">114
</span><span class="lnt">115
</span><span class="lnt">116
</span><span class="lnt">117
</span><span class="lnt">118
</span><span class="lnt">119
</span><span class="lnt">120
</span><span class="lnt">121
</span><span class="lnt">122
</span><span class="lnt">123
</span><span class="lnt">124
</span><span class="lnt">125
</span><span class="lnt">126
</span><span class="lnt">127
</span><span class="lnt">128
</span><span class="lnt">129
</span><span class="lnt">130
</span><span class="lnt">131
</span><span class="lnt">132
</span><span class="lnt">133
</span><span class="lnt">134
</span><span class="lnt">135
</span><span class="lnt">136
</span><span class="lnt">137
</span><span class="lnt">138
</span><span class="lnt">139
</span><span class="lnt">140
</span><span class="lnt">141
</span><span class="lnt">142
</span><span class="lnt">143
</span><span class="lnt">144
</span><span class="lnt">145
</span><span class="lnt">146
</span><span class="lnt">147
</span><span class="lnt">148
</span><span class="lnt">149
</span><span class="lnt">150
</span><span class="lnt">151
</span><span class="lnt">152
</span><span class="lnt">153
</span><span class="lnt">154
</span><span class="lnt">155
</span><span class="lnt">156
</span><span class="lnt">157
</span><span class="lnt">158
</span><span class="lnt">159
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-CSharp" data-lang="CSharp"><span class="k">using</span> <span class="nn">System</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Collections.Generic</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.ComponentModel</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Data</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Drawing</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Linq</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Text</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Threading.Tasks</span><span class="p">;</span>
<span class="k">using</span> <span class="nn">System.Windows.Forms</span><span class="p">;</span>

<span class="k">namespace</span> <span class="nn">AntColonyOptimization</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="k">partial</span> <span class="k">class</span> <span class="nc">AntCoOp</span> <span class="p">:</span> <span class="n">Form</span>
    <span class="p">{</span>
        <span class="k">public</span> <span class="n">AntCoOp</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="n">InitializeComponent</span><span class="p">();</span>
            <span class="n">InitData</span><span class="p">();</span>

        <span class="p">}</span>


        <span class="k">public</span> <span class="k">static</span> <span class="n">Tsp</span> <span class="n">Calculate</span><span class="p">()</span>
        <span class="p">{</span>

            <span class="n">Tsp</span> <span class="n">tspant</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Tsp</span><span class="p">();</span>
            <span class="n">tspant</span><span class="p">.</span><span class="n">InitEnvironment</span><span class="p">();</span>
            <span class="n">tspant</span><span class="p">.</span><span class="n">Search</span><span class="p">();</span>

            <span class="k">return</span> <span class="n">tspant</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="cp">#region
</span><span class="cp"></span>        <span class="n">Tsp</span> <span class="n">tsp</span> <span class="p">=</span> <span class="n">Calculate</span><span class="p">();</span>

        <span class="kt">bool</span> <span class="n">DrawLine</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="n">Ant</span> <span class="n">OneBestAnt</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Ant</span><span class="p">();</span>
        <span class="n">Pen</span> <span class="n">DotPen</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pen</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">Blue</span><span class="p">,</span> <span class="m">3</span><span class="p">);</span>
        <span class="n">Pen</span> <span class="n">LinePen</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Pen</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">Red</span><span class="p">,</span> <span class="m">1</span><span class="p">);</span>
        <span class="kt">double</span> <span class="n">xMax</span> <span class="p">=</span> <span class="m">0.0</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">yMax</span> <span class="p">=</span> <span class="m">0.0</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">xMin</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">BigNum</span><span class="p">;</span>
        <span class="kt">double</span> <span class="n">yMin</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">BigNum</span><span class="p">;</span>

        <span class="kt">double</span><span class="na">[]</span> <span class="n">xxCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[DataAndCal.CityNum]</span><span class="p">;</span>
        <span class="kt">double</span><span class="na">[]</span> <span class="n">yyCity</span> <span class="p">=</span> <span class="k">new</span> <span class="kt">double</span><span class="na">[DataAndCal.CityNum]</span><span class="p">;</span>

        <span class="kt">int</span> <span class="n">nextBtni</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
        <span class="k">private</span> <span class="k">void</span> <span class="n">InitData</span><span class="p">()</span>
        <span class="p">{</span>
            <span class="c1">//找出城市坐标最大值
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">xCity</span><span class="na">[i]</span> <span class="p">&gt;</span> <span class="n">xMax</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">xMax</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">xCity</span><span class="na">[i]</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">yCity</span><span class="na">[i]</span> <span class="p">&gt;</span> <span class="n">yMax</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">yMax</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">yCity</span><span class="na">[i]</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">xCity</span><span class="na">[i]</span> <span class="p">&lt;</span> <span class="n">xMin</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">xMin</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">xCity</span><span class="na">[i]</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">yCity</span><span class="na">[i]</span> <span class="p">&lt;</span> <span class="n">yMin</span><span class="p">)</span>
                <span class="p">{</span>
                    <span class="n">yMin</span> <span class="p">=</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">yCity</span><span class="na">[i]</span><span class="p">;</span>
                <span class="p">}</span>
            <span class="p">}</span>

            <span class="n">xMax</span> <span class="p">=</span> <span class="n">xMax</span> <span class="p">+</span> <span class="m">10</span><span class="p">;</span>
            <span class="n">yMax</span> <span class="p">=</span> <span class="n">yMax</span> <span class="p">+</span> <span class="m">10</span><span class="p">;</span>
            <span class="c1">//xMin = 0.0;
</span><span class="c1"></span>            <span class="c1">//yMin = 0.0;
</span><span class="c1"></span>            <span class="c1">//画出所有点，按比例
</span><span class="c1"></span>            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">xxCity</span><span class="na">[i]</span> <span class="p">=</span> <span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">xCity</span><span class="na">[i]</span> <span class="p">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="p">/</span> <span class="p">(</span><span class="n">xMax</span> <span class="p">-</span> <span class="n">xMin</span><span class="p">)</span> <span class="p">*</span> <span class="n">PaintPanel</span><span class="p">.</span><span class="n">Width</span> <span class="p">+</span> <span class="n">xMin</span><span class="p">;</span>
                <span class="n">yyCity</span><span class="na">[i]</span> <span class="p">=</span> <span class="p">(</span><span class="n">DataAndCal</span><span class="p">.</span><span class="n">yCity</span><span class="na">[i]</span> <span class="p">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="p">/</span> <span class="p">(</span><span class="n">yMax</span> <span class="p">-</span> <span class="n">yMin</span><span class="p">)</span> <span class="p">*</span> <span class="n">PaintPanel</span><span class="p">.</span><span class="n">Height</span> <span class="p">+</span> <span class="n">yMin</span><span class="p">;</span>

            <span class="p">}</span>
        <span class="p">}</span>

        <span class="cp">#endregion
</span><span class="cp"></span>

        <span class="k">private</span> <span class="k">void</span> <span class="n">PaintPanel_Paint</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">PaintEventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>

            <span class="n">Graphics</span> <span class="n">g</span> <span class="p">=</span> <span class="n">e</span><span class="p">.</span><span class="n">Graphics</span><span class="p">;</span>

            <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">DataAndCal</span><span class="p">.</span><span class="n">CityNum</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
            <span class="p">{</span>
                <span class="n">g</span><span class="p">.</span><span class="n">DrawEllipse</span><span class="p">(</span><span class="n">DotPen</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">xxCity</span><span class="na">[i]</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">yyCity</span><span class="na">[i]</span><span class="p">,</span> <span class="m">2</span><span class="p">,</span> <span class="m">2</span><span class="p">);</span>
            <span class="p">}</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">DrawLine</span><span class="p">)</span>
            <span class="p">{</span>
                <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="p">&lt;</span> <span class="n">OneBestAnt</span><span class="p">.</span><span class="n">DoneCity</span><span class="p">.</span><span class="n">Count</span><span class="p">()</span> <span class="p">-</span> <span class="m">1</span><span class="p">;</span> <span class="n">i</span><span class="p">++)</span>
                <span class="p">{</span>
                    <span class="n">g</span><span class="p">.</span><span class="n">DrawLine</span><span class="p">(</span><span class="n">LinePen</span><span class="p">,</span> <span class="k">new</span> <span class="n">PointF</span><span class="p">((</span><span class="kt">float</span><span class="p">)</span><span class="n">xxCity</span><span class="na">[OneBestAnt.DoneCity[i]</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">yyCity</span><span class="na">[OneBestAnt.DoneCity[i]</span><span class="p">]),</span> <span class="k">new</span> <span class="n">PointF</span><span class="p">((</span><span class="kt">float</span><span class="p">)</span><span class="n">xxCity</span><span class="na">[OneBestAnt.DoneCity[i + 1]</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">yyCity</span><span class="na">[OneBestAnt.DoneCity[i + 1]</span><span class="p">]));</span>

                <span class="p">}</span>
                <span class="n">g</span><span class="p">.</span><span class="n">DrawLine</span><span class="p">(</span><span class="n">LinePen</span><span class="p">,</span> <span class="k">new</span> <span class="n">PointF</span><span class="p">((</span><span class="kt">float</span><span class="p">)</span><span class="n">xxCity</span><span class="na">[OneBestAnt.DoneCity[0]</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">yyCity</span><span class="na">[OneBestAnt.DoneCity[0]</span><span class="p">]),</span> <span class="k">new</span> <span class="n">PointF</span><span class="p">((</span><span class="kt">float</span><span class="p">)</span><span class="n">xxCity</span><span class="na">[OneBestAnt.DoneCity[DataAndCal.CityNum - 1]</span><span class="p">],</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">yyCity</span><span class="na">[OneBestAnt.DoneCity[DataAndCal.CityNum - 1]</span><span class="p">]));</span>

                <span class="kt">string</span> <span class="n">strInfo1</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;当前值：{0}，最优值：{1} &#34;</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">OneBestAnt</span><span class="p">.</span><span class="n">LineLength</span><span class="p">,</span> <span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="p">.</span><span class="n">Last</span><span class="p">().</span><span class="n">LineLength</span><span class="p">);</span>
                <span class="kt">string</span> <span class="n">strInfo2</span> <span class="p">=</span> <span class="n">String</span><span class="p">.</span><span class="n">Format</span><span class="p">(</span><span class="s">&#34;共有{0}个迭代值，第{1}个 &#34;</span><span class="p">,</span> <span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="p">.</span><span class="n">Count</span><span class="p">(),</span> <span class="n">nextBtni</span><span class="p">);</span>
                <span class="n">Brush</span> <span class="n">strBru</span> <span class="p">=</span> <span class="k">new</span> <span class="n">SolidBrush</span><span class="p">(</span><span class="n">Color</span><span class="p">.</span><span class="n">Black</span><span class="p">);</span>
                <span class="n">Font</span> <span class="n">strFont</span> <span class="p">=</span> <span class="k">new</span> <span class="n">Font</span><span class="p">(</span><span class="s">&#34;微软雅黑&#34;</span><span class="p">,</span> <span class="m">14</span><span class="p">);</span>
                <span class="n">g</span><span class="p">.</span><span class="n">DrawString</span><span class="p">(</span><span class="n">strInfo1</span><span class="p">,</span> <span class="n">strFont</span><span class="p">,</span> <span class="n">strBru</span><span class="p">,</span> <span class="k">new</span> <span class="n">PointF</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">PaintPanel</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">60</span><span class="p">));</span>
                <span class="n">g</span><span class="p">.</span><span class="n">DrawString</span><span class="p">(</span><span class="n">strInfo2</span><span class="p">,</span> <span class="n">strFont</span><span class="p">,</span> <span class="n">strBru</span><span class="p">,</span> <span class="k">new</span> <span class="n">PointF</span><span class="p">(</span><span class="m">20</span><span class="p">,</span> <span class="p">(</span><span class="kt">float</span><span class="p">)</span><span class="n">PaintPanel</span><span class="p">.</span><span class="n">Height</span> <span class="p">-</span> <span class="m">35</span><span class="p">));</span>
            <span class="p">}</span>
            <span class="n">DrawLine</span> <span class="p">=</span> <span class="k">false</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="n">PaintPanel_SizeChanged</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Refresh</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="n">RefreshBtn_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">tsp</span> <span class="p">=</span> <span class="n">Calculate</span><span class="p">();</span>
            <span class="n">nextBtni</span> <span class="p">=</span> <span class="m">0</span><span class="p">;</span>
            <span class="c1">//Refresh();
</span><span class="c1"></span>            <span class="c1">//PaintPanel.Paint();
</span><span class="c1"></span>        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="n">NextBtn_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">nextBtni</span> <span class="p">&lt;</span> <span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="p">.</span><span class="n">Count</span><span class="p">())</span>
            <span class="p">{</span>
                <span class="n">OneBestAnt</span> <span class="p">=</span> <span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="na">[nextBtni]</span><span class="p">;</span>
                <span class="n">DrawLine</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
                <span class="n">nextBtni</span><span class="p">++;</span>
                <span class="n">Refresh</span><span class="p">();</span>
            <span class="p">}</span>

        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="n">FinalBtn_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OneBestAnt</span> <span class="p">=</span> <span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="p">.</span><span class="n">Last</span><span class="p">();</span>
            <span class="n">DrawLine</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">nextBtni</span> <span class="p">=</span> <span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="p">.</span><span class="n">Count</span><span class="p">();</span>

            <span class="n">Refresh</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">private</span> <span class="k">void</span> <span class="n">ReturnBtn_Click</span><span class="p">(</span><span class="kt">object</span> <span class="n">sender</span><span class="p">,</span> <span class="n">EventArgs</span> <span class="n">e</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">OneBestAnt</span> <span class="p">=</span> <span class="n">tsp</span><span class="p">.</span><span class="n">bestAntList</span><span class="p">.</span><span class="n">First</span><span class="p">();</span>
            <span class="n">DrawLine</span> <span class="p">=</span> <span class="k">true</span><span class="p">;</span>
            <span class="n">nextBtni</span> <span class="p">=</span> <span class="m">1</span><span class="p">;</span>
            <span class="n">Refresh</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></td></tr></table>
</div>
</div></p>

<p>运行截图就不再给了，也不是什么很好看的图</p>

<p>以前从来被人碾压习惯了突然变成这样其实也挺不习惯的，要多和更强的人比比才行，不然没有进步的，我可不是混个硕士毕业证就志得意满去工作的人。</p>

  </section>

  <section>
    
      
    
  </section>
</article>

      </div>

      <div id="side" class="pr-1 bg-white">
        <aside class="pr-3">
          
  
    <div id="toc" class="Box Box--blue mb-3">
      <b>基于C#的蚁群算法实现</b>
      
    </div>
  

  
    <div>
      
    </div>
  

        </aside>
      </div>

      <div id="footer" class="pt-2 pb-3 bg-white text-center">
        

  <span class="text-small text-gray">
    &copy;keaising 2014 - 2019 &middot; 

    Powered by the
    <a href="https://github.com/qqhann/hugo-primer" class="link-gray-dark">Hugo-Primer</a> theme for
    <a href="https://gohugo.io" class="link-gray-dark">Hugo</a>.
  </span>


      </div>
    </div>


    
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { inlineMath: [['$','$'], ['\\(','\\)']] } });</script>
  </body>
</html>
